{"version":3,"file":"http-interceptor.js","sourceRoot":"","sources":["../../src/client/http-interceptor.ts"],"names":[],"mappings":";;;AAAA,8CAAmD;AAMnD,MAAa,eAAe;IACN;IAApB,YAAoB,WAAmB;QAAnB,gBAAW,GAAX,WAAW,CAAQ;IAAG,CAAC;IAK3C,KAAK,CAAC,GAA2B,EAAE,IAAkB;QACnD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAG3C,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAY,CAAC,cAAc,CAAC,EAAE,CAAC;YAC9C,OAAO,CAAC,GAAG,CAAC,mBAAY,CAAC,cAAc,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAC7D,CAAC;QAED,OAAO,KAAK,CAAC,GAAG,EAAE;YAChB,GAAG,IAAI;YACP,OAAO;SACR,CAAC,CAAC;IACL,CAAC;IAMD,iBAAiB;QACf,OAAO;YACL,CAAC,mBAAY,CAAC,cAAc,CAAC,EAAE,IAAI,CAAC,WAAW;SAChD,CAAC;IACJ,CAAC;IAKD,SAAS,CAAC,KAAU;QAElB,KAAK,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAW,EAAE,EAAE;YAC7C,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC;YACtC,MAAM,CAAC,OAAO,CAAC,mBAAY,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC;YAC/D,OAAO,MAAM,CAAC;QAChB,CAAC,CAAC,CAAC;QACH,OAAO,KAAK,CAAC;IACf,CAAC;CACF;AA1CD,0CA0CC","sourcesContent":["import { HTTP_HEADERS } from '@lattice.black/core';\n\n/**\n * HTTP client interceptor that injects distributed tracing headers\n * for service-to-service connection tracking\n */\nexport class HttpInterceptor {\n  constructor(private serviceName: string) {}\n\n  /**\n   * Wrap fetch to automatically inject X-Origin-Service header\n   */\n  fetch(url: string | URL | Request, init?: RequestInit): Promise<Response> {\n    const headers = new Headers(init?.headers);\n\n    // Inject origin service header for distributed tracing\n    if (!headers.has(HTTP_HEADERS.ORIGIN_SERVICE)) {\n      headers.set(HTTP_HEADERS.ORIGIN_SERVICE, this.serviceName);\n    }\n\n    return fetch(url, {\n      ...init,\n      headers,\n    });\n  }\n\n  /**\n   * Get headers to inject for manual HTTP clients\n   * Use this with axios, node-fetch, or other HTTP libraries\n   */\n  getTracingHeaders(): Record<string, string> {\n    return {\n      [HTTP_HEADERS.ORIGIN_SERVICE]: this.serviceName,\n    };\n  }\n\n  /**\n   * Wrap axios instance to automatically inject headers\n   */\n  wrapAxios(axios: any) {\n    // Add request interceptor\n    axios.interceptors.request.use((config: any) => {\n      config.headers = config.headers || {};\n      config.headers[HTTP_HEADERS.ORIGIN_SERVICE] = this.serviceName;\n      return config;\n    });\n    return axios;\n  }\n}\n"]}