# Production Environment Variables Template
# Copy this file to .env.production and fill in the values
# DO NOT commit .env.production to version control

# ============================================================================
# DATABASE
# ============================================================================

# Local dev database (not used in production, but keep for local builds)
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/lattice"

# ============================================================================
# REDIS
# ============================================================================

# Production Redis instance
# Options: Railway Redis, Upstash, Redis Cloud, ElastiCache
REDIS_URL="redis://your-production-redis-host:6379"

# ============================================================================
# API CONFIGURATION
# ============================================================================

PORT=3000
NODE_ENV="production"

# Strong API key for admin/internal operations
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
LATTICE_API_KEY="CHANGE_ME_generate_a_strong_random_key"

# ============================================================================
# CORS
# ============================================================================

# Your production domains (comma-separated, no spaces)
ALLOWED_ORIGINS="https://your-production-domain.com,https://app.your-domain.com"

# ============================================================================
# SUPABASE
# ============================================================================

# Your Supabase project URL
SUPABASE_URL="https://hgruvuhrtznijhsqvagn.supabase.co"

# Service Role Key (has full access, bypasses RLS)
# Found in: Supabase Dashboard > Settings > API > service_role key
SUPABASE_SERVICE_KEY="CHANGE_ME_your_production_service_role_key"

# ============================================================================
# SUPABASE DATABASE CONNECTION (Production Pooler)
# ============================================================================

# Connection pooler settings for production
# Found in: Supabase Dashboard > Settings > Database > Connection Pooling
SUPABASE_DB_HOST="aws-1-us-east-2.pooler.supabase.com"
SUPABASE_DB_PORT="6543"
SUPABASE_DB_NAME="postgres"
SUPABASE_DB_USER="postgres.hgruvuhrtznijhsqvagn"

# Production database password
# Found in: Supabase Dashboard > Settings > Database
SUPABASE_DB_PASSWORD="CHANGE_ME_your_production_database_password"

# ============================================================================
# STRIPE - LIVE MODE KEYS
# ============================================================================

# IMPORTANT: Use LIVE keys (sk_live_* and pk_live_*), not test keys!
# Found in: Stripe Dashboard > Developers > API keys (toggle Live mode ON)

# Live Secret Key (server-side only)
STRIPE_SECRET_KEY="CHANGE_ME_sk_live_your_live_secret_key"

# Live Publishable Key (can be exposed to clients)
STRIPE_PUBLISHABLE_KEY="CHANGE_ME_pk_live_your_live_publishable_key"

# Production Webhook Signing Secret
# Created in: Stripe Dashboard > Developers > Webhooks > Add endpoint
# Endpoint URL: https://your-domain.com/api/v1/webhooks/stripe
# Events: checkout.session.completed, customer.subscription.*, invoice.payment_*
STRIPE_WEBHOOK_SECRET="CHANGE_ME_whsec_your_production_webhook_secret"

# ============================================================================
# STRIPE PRICE IDS - LIVE MODE
# ============================================================================

# Live price IDs for your subscription tiers
# Found in: Stripe Dashboard > Products (with Live mode ON)
# Click on each product to see its price ID

# Basic tier live price ID
STRIPE_PRICE_ID_BASIC="CHANGE_ME_price_your_live_basic_price_id"

# Pro tier live price ID
STRIPE_PRICE_ID_PRO="CHANGE_ME_price_your_live_pro_price_id"

# Enterprise tier live price ID
STRIPE_PRICE_ID_ENTERPRISE="CHANGE_ME_price_your_live_enterprise_price_id"

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================

# Before deploying, verify:
# [ ] All CHANGE_ME values have been replaced with actual production values
# [ ] Stripe keys are LIVE mode keys (sk_live_* and pk_live_*)
# [ ] Stripe price IDs are from LIVE mode products
# [ ] CORS origins are set to your actual production domains
# [ ] LATTICE_API_KEY is a strong random string
# [ ] Database credentials are correct and tested
# [ ] Redis URL is accessible from your production environment
# [ ] Webhook secret is from your production webhook endpoint
# [ ] This file is added to .gitignore
# [ ] RLS migration has been run on production database

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================

# Most deployment platforms allow setting environment variables via:
# - Web dashboard (Railway, Render, Vercel, Fly.io)
# - CLI commands (fly secrets set, railway vars set)
# - Environment files (.env for Docker)

# For Docker:
# docker run -p 3000:3000 --env-file .env.production lattice-api

# For Railway:
# railway variables set < .env.production

# For Render:
# Add variables in dashboard under Environment tab

# For Fly.io:
# fly secrets set $(cat .env.production | xargs)

# ============================================================================
# SECURITY REMINDERS
# ============================================================================

# 1. NEVER commit .env.production to Git
# 2. NEVER expose SUPABASE_SERVICE_KEY to client-side code
# 3. NEVER use test mode Stripe keys in production
# 4. ALWAYS use HTTPS in production (required for Stripe webhooks)
# 5. ALWAYS use strong passwords and rotate credentials periodically
# 6. ALWAYS enable RLS before accepting real user data
